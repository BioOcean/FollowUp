@page "/"
@using FollowUp.Services
@using FollowUp.Constants
@inject INavigationService inj_navigationService
@inject ILogger<Home> inj_logger
@inject NavigationManager inj_navigationManager
@attribute [AllowAnonymous]

<PageTitle>FollowUp 随访管理系统</PageTitle>

<div class="d-flex justify-center align-center" style="height: 100vh;">
    <MudProgressCircular Color="Color.Primary" Indeterminate="true" Size="Size.Large" />
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        try
        {
            inj_logger.LogInformation("Home 页面初始化开始");

            // 使用统一的导航服务获取首页路径
            var homePage = await inj_navigationService.GetHomePageAsync();

            inj_logger.LogInformation("跳转到首页: {HomePage}", homePage);
            inj_navigationManager.NavigateTo(homePage, true);
        }
        catch (Exception ex)
        {
            inj_logger.LogError(ex, "角色路由失败");
            inj_navigationManager.NavigateTo(RouteConstants.Login, true);
        }
    }
}

